(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[251],{3251:function(e,t,s){Promise.resolve().then(s.bind(s,49)),Promise.resolve().then(s.bind(s,9768)),Promise.resolve().then(s.bind(s,6784))},49:function(e,t,s){"use strict";s.d(t,{default:function(){return a}});var n=s(7437);function a(e){let{pkg:t}=e,s=e=>{window.dispatchEvent(new CustomEvent("open-payment",{detail:e}))};return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-bold text-gray-800",children:t.title}),t.unlimited&&(0,n.jsx)("span",{className:"text-xs text-green-600",children:"UNLIMITED"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[t.hours," Hours"]})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("p",{className:"text-lg font-bold text-green-700",children:["UGX ",t.price]}),(0,n.jsx)("button",{onClick:()=>s(t),className:"mt-2 px-6 py-2 bg-green-600 text-white rounded-full text-sm font-medium hover:bg-green-700",children:"BUY"})]})]})}},9768:function(e,t,s){"use strict";s.d(t,{default:function(){return i}});var n=s(7437),a=s(2265),l=s(6648);let r=()=>{var e;null===(e=document.getElementById("payment-modal"))||void 0===e||e.close()};function i(){let[e,t]=(0,a.useState)(""),[s,i]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1),[d,u]=(0,a.useState)("mtn"),[m,h]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=e=>{i(e.detail),p(!1),h(""),t(""),j(!1),document.getElementById("payment-modal").showModal()};return window.addEventListener("open-payment",e),()=>window.removeEventListener("open-payment",e)},[]),(0,a.useEffect)(()=>{if(!m||!x)return;j(!0);let e=setInterval(async()=>{try{let t=await fetch("/api/vouchers/status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactionId:m})}),s=await t.json();s.success&&s.hasVoucher&&"COMPLETED"===s.status&&(clearInterval(e),j(!1),window.dispatchEvent(new CustomEvent("voucher-ready",{detail:{username:s.username,password:s.voucher}})),setTimeout(()=>{r(),p(!1),h(""),alert("Payment confirmed! Your credentials have been filled in automatically.")},1e3))}catch(e){console.error("Error checking payment status:",e)}},2e3),t=setTimeout(()=>{clearInterval(e),j(!1)},12e4);return()=>{clearInterval(e),clearTimeout(t)}},[m,x]);let v=async()=>{if(!e||!s)return;o(!0),p(!1),h("");let t=await fetch("/api/".concat(d,"/initiate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:e,amount:s.price,packageId:s.id})}),n=await t.json();n.success?(h(n.transactionId),p(!0),j(!0)):alert("Payment failed: "+(n.error||"Try again")),o(!1)};return(0,n.jsx)("dialog",{id:"payment-modal",className:"modal",children:(0,n.jsxs)("div",{className:"modal-box",children:[(0,n.jsx)("h3",{className:"font-bold text-lg",children:"Confirm Payment"}),s&&(0,n.jsxs)("p",{className:"py-2",children:[s.title," – ",(0,n.jsxs)("strong",{children:["UGX ",s.price.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,n.jsxs)("button",{onClick:()=>u("airtel"),className:"flex-1 btn ".concat("airtel"===d?"btn-success":"btn-outline"),children:[(0,n.jsx)(l.default,{src:"/airtel.png",alt:"Airtel",width:20,height:20,className:"mr-1"}),"Airtel"]}),(0,n.jsxs)("button",{onClick:()=>u("mtn"),className:"flex-1 btn ".concat("mtn"===d?"btn-success":"btn-outline"),children:[(0,n.jsx)(l.default,{src:"/mtn.png",alt:"MTN",width:20,height:20,className:"mr-1"}),"MTN"]})]}),x&&m?(0,n.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,n.jsxs)("div",{className:"alert ".concat(b?"alert-warning":"alert-info"),children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current shrink-0 w-6 h-6",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{className:"text-sm",children:b?"Waiting for payment confirmation... Your credentials will be filled automatically once confirmed.":"Check your phone and approve the payment!"})]}),(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.jsxs)("p",{className:"text-xs text-gray-600 mb-2",children:[(0,n.jsx)("strong",{children:"Save this Transaction ID"})," to retrieve your voucher later:"]}),(0,n.jsx)("div",{className:"bg-white rounded p-3 border border-blue-300",children:(0,n.jsx)("p",{className:"font-mono text-sm font-bold text-blue-700 break-all",children:m})}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:'Your voucher will be sent via SMS/WhatsApp once payment is confirmed. If you lose it, use this Transaction ID in "Find My Voucher".'})]}),(0,n.jsx)("div",{className:"modal-action mt-4",children:(0,n.jsx)("button",{className:"btn btn-success w-full",onClick:()=>{r(),p(!1),h("")},children:"Close"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"tel",placeholder:"Enter Mobile Money number (e.g. 07xx)",className:"input input-bordered w-full mt-4",value:e,onChange:e=>t(e.target.value)}),(0,n.jsxs)("div",{className:"modal-action",children:[(0,n.jsx)("button",{className:"btn",onClick:r,children:"Cancel"}),(0,n.jsx)("button",{className:"btn btn-success",onClick:v,disabled:c||!e,children:c?"Processing...":"Pay Now"})]})]})]})})}},6784:function(e,t,s){"use strict";s.d(t,{default:function(){return l}});var n=s(7437),a=s(2265);function l(){let[e,t]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),[r,i]=(0,a.useState)(!1),[c,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[x,p]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=e=>{var s,n;(null===(s=e.detail)||void 0===s?void 0:s.username)&&(null===(n=e.detail)||void 0===n?void 0:n.password)&&(t(e.detail.username),l(e.detail.password),console.log("Voucher credentials auto-filled!"))};return window.addEventListener("voucher-ready",e),()=>window.removeEventListener("voucher-ready",e)},[]);let b=async()=>{if(!e||!s)return alert("Please enter both username and password");let t=await fetch("/api/vouchers/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:s})});alert((await t.json()).valid?"Connected!":"Invalid username or password")},j=async()=>{if(!c.trim()){p("Please enter your transaction ID");return}u(!0),p(""),h(null);try{let e=await fetch("/api/vouchers/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactionId:c.trim()})}),s=await e.json();s.success?(h(s),s.username&&t(s.username),l(s.voucher),setTimeout(()=>{i(!1)},3e3)):p(s.error||"Transaction not found")}catch(e){p("Failed to retrieve voucher. Please try again.")}finally{u(!1)}},v=()=>{i(!1),o(""),p(""),h(null)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 mb-8",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label justify-center",children:(0,n.jsx)("span",{className:"label-text",children:"Username"})}),(0,n.jsx)("input",{type:"text",placeholder:"Enter username",className:"input input-bordered w-full text-center",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>"Enter"===e.key&&b()})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label justify-center",children:(0,n.jsx)("span",{className:"label-text",children:"Password"})}),(0,n.jsx)("input",{type:"password",placeholder:"Enter password",className:"input input-bordered w-full text-center",value:s,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&b()})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("button",{type:"button",onClick:b,className:"w-full px-6 py-3 bg-green-600 text-white rounded-lg text-base font-medium hover:bg-green-700 transition-colors cursor-pointer",style:{display:"block",width:"100%"},children:"Login"})})]}),(0,n.jsx)("button",{onClick:()=>i(!0),className:"link link-primary text-sm mt-3 block text-center w-full",children:"Already bought? Find My Voucher"})]}),r&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Find My Voucher"}),(0,n.jsx)("button",{onClick:v,className:"btn btn-sm btn-circle btn-ghost",children:"✕"})]}),m?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"alert alert-success",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{children:"Voucher found!"})]}),(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 space-y-3",children:[m.username&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Username:"}),(0,n.jsx)("p",{className:"text-xl font-bold text-green-700 font-mono",children:m.username})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Password / Voucher Code:"}),(0,n.jsx)("p",{className:"text-xl font-bold text-green-700 font-mono",children:m.voucher})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm pt-2 border-t border-green-200",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-500",children:"Provider:"}),(0,n.jsx)("p",{className:"font-semibold",children:m.provider})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-500",children:"Amount:"}),(0,n.jsxs)("p",{className:"font-semibold",children:["UGX ",m.amount]})]})]})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Use these credentials to log in to the WiFi network."}),(0,n.jsx)("button",{onClick:v,className:"btn btn-success text-white w-full",children:"Close"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the transaction ID you received after payment to retrieve your voucher code."}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label",children:(0,n.jsx)("span",{className:"label-text",children:"Transaction ID"})}),(0,n.jsx)("input",{type:"text",placeholder:"Enter transaction ID",className:"input input-bordered w-full",value:c,onChange:e=>o(e.target.value),onKeyPress:e=>"Enter"===e.key&&j()})]}),x&&(0,n.jsx)("div",{className:"alert alert-error",children:(0,n.jsx)("span",{className:"text-sm",children:x})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:v,className:"btn btn-outline flex-1",children:"Cancel"}),(0,n.jsx)("button",{onClick:j,disabled:d,className:"btn btn-success text-white flex-1",children:d?"Searching...":"Find Voucher"})]})]})]})]})})]})}}}]);