"use strict";(()=>{var e={};e.id=319,e.ids=[319],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3607:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>d,patchFetch:()=>m,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c});var r={};a.r(r),a.d(r,{POST:()=>i});var o=a(9303),n=a(8716),s=a(670);async function i(e){let t=await e.json(),{referenceId:a,status:r,financialTransactionId:o}=t;if(console.log("MTN Callback:",t),"SUCCESSFUL"===r){let e=global.mtnTransactions?.[a];if(e){var n;let t=(n=e.packageId,{username:"BUSOWA"+Math.random().toString(36).substring(2,6).toUpperCase(),code:Math.random().toString(36).substring(2,10).toUpperCase(),...{1:{hours:8},2:{hours:24},3:{hours:48}}[n]});await fetch("/api/vouchers/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:e.phone,username:t.username,code:t.code})}),e.status="COMPLETED",e.voucher=t.code,e.username=t.username}}return Response.json({received:!0})}let p=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/mtn/callback/route",pathname:"/api/mtn/callback",filename:"route",bundlePath:"app/api/mtn/callback/route"},resolvedPagePath:"C:\\Users\\DJ PROPERTY\\Desktop\\busowa-wifi-hotspot\\app\\api\\mtn\\callback\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:c,serverHooks:l}=p,d="/api/mtn/callback/route";function m(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:c})}},9303:(e,t,a)=>{e.exports=a(517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948],()=>a(3607));module.exports=r})();